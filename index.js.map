{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\naxios.defaults.baseURL = `https://pixabay.com/api/`;\n\n// need to remove it to env variables or secured storage\nexport const API_KEY = '49355059-ef28fa3d6cd8d2c420ac797e4';\n\nexport async function fetchSearchData(\n  search_phrase,\n  page_number = 1,\n  fetch_per_page = 15\n) {\n  const request_options = {\n    params: {\n      key: API_KEY,\n      q: search_phrase,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page_number,\n      per_page: fetch_per_page,\n    },\n  };\n  const response_data = (await axios.get('', request_options)).data;\n  try {\n    if (!response_data.hits || response_data.hits.length === 0) {\n      const errorText =\n        'âŒ Sorry, there are no images matching your search query. Please try again!';\n      showError(errorText);\n    }\n    return response_data;\n  } catch {\n    console.error('Error fetching data:', error);\n    throw error;\n  }\n}\n\nexport function showError(errorText) {\n  iziToast.show({\n    title: '',\n    message: errorText,\n    backgroundColor: '#FF5B61',\n    titleColor: 'white',\n    messageColor: 'white',\n    position: 'topRight',\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst gallery_config = {\n  captionsData: 'alt',\n  captionDelay: 250,\n};\n\nexport function renderImageMarkup(images, append = false) {\n  if (!images || images.length === 0) {\n    gallery.innerHTML = '';\n    return;\n  }\n\n  const galleryMarkup = images\n    .map(\n      img => `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${img.webformatURL}\"\n          alt=\"${img.tags}\"\n        />\n      </a>\n          <div class=\"image-info\">\n        <p class=\"image-info-text\"><strong>Likes</strong> <span>${img.likes}</span></p>\n        <p class=\"image-info-text\"><strong>Views</strong> <span>${img.views}</span></p>\n        <p class=\"image-info-text\"><strong>Comments</strong> <span>${img.comments}</span></p>\n        <p class=\"image-info-text\"><strong>Downloads</strong> <span>${img.downloads}</span></p>\n      </div>\n    </li>\n  `\n    )\n    .join('');\n  if (append) {\n    gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n  } else {\n    gallery.innerHTML = galleryMarkup;\n  }\n\n  const lightbox = new SimpleLightbox('.gallery a', gallery_config);\n  lightbox.refresh();\n}\n","import { fetchSearchData, showError } from './js/pixabay-api';\nimport { renderImageMarkup } from './js/render-functions';\n\nconst search_form = document.getElementById('search-form');\nconst loader = document.getElementById('loader');\nconst loadMoreBtn = document.querySelector('.load-more-button-js');\nconst gallery = document.querySelector('.gallery');\n\nlet page = 1;\nlet perPage = 15;\nlet search_phrase = '';\n\nsearch_form.addEventListener('submit', search_image);\nloadMoreBtn.addEventListener('click', load_more_images);\n\nasync function search_image(event) {\n  try {\n    event.preventDefault();\n    page = 1;\n    loader.style.display = 'block';\n    search_phrase = event.currentTarget.elements.query.value.trim();\n\n    if (!search_phrase) {\n      showError('The request cant be empty, please fill in the input value!');\n      loader.style.display = 'none';\n      return;\n    }\n\n    event.currentTarget.reset();\n    gallery.innerHTML = '';\n    loadMoreBtn.style.display = 'none';\n    const data = await fetchSearchData(search_phrase, page);\n    loader.style.display = 'none';\n    renderImageMarkup(data.hits);\n    loadMoreBtn.style.display = 'inline-block';\n    if (data.hits.length === 0) {\n      loadMoreBtn.style.display = 'none';\n    }\n  } catch (err) {\n    console.error(err);\n    showError(err.response.data);\n    loader.style.display = 'none';\n    loadMoreBtn.style.display = 'none';\n  }\n}\n\nasync function load_more_images(event) {\n  try {\n    page += 1;\n    event.target.style.display = 'none';\n    event.target.insertAdjacentElement('beforebegin', loader);\n    loader.style.display = 'block';\n\n    const data = await fetchSearchData(search_phrase, page);\n    const totalPages = data.totalHits / perPage;\n    loader.style.display = 'none';\n\n    if (page >= totalPages) {\n      event.target.style.display = 'none';\n      showError(\"We're sorry, but you've reached the end of search results.\");\n      loadMoreBtn.removeEventListener('click', load_more_images);\n    } else {\n      event.target.style.display = 'inline-block';\n      renderImageMarkup(data.hits, true);\n\n      const galleryItem = document.querySelector('.gallery-item');\n      const itemHeight = galleryItem.getBoundingClientRect().height;\n\n      const scrollSize = itemHeight * 2;\n      window.scrollBy({ top: scrollSize, behavior: 'smooth' });\n    }\n  } catch (err) {\n    console.error(err);\n  }\n}\n"],"names":["axios","API_KEY","fetchSearchData","search_phrase","page_number","fetch_per_page","request_options","response_data","showError","errorText","iziToast","gallery","gallery_config","renderImageMarkup","images","append","galleryMarkup","img","SimpleLightbox","search_form","loader","loadMoreBtn","page","perPage","search_image","load_more_images","event","data","err","totalPages","scrollSize"],"mappings":"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"}